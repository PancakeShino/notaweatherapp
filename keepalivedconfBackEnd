#prereqs apt-get install curl gcc libssl-dev libnl-3-dev libnl-genl-3-dev libsnmp-dev
#apt-get install keepalived
#GOES IN /etc/keepalived/keepalived.conf

vrrp_instance VI_1 {
    state MASTER            # "BACKUP" on the backup machine
    interface eth0          # Network interface for the VIP
    virtual_router_id 51
    priority 101            # Lower priority on the backup machine eg 100
    advert_int 1

    authentication {
        auth_type PASS
        auth_pass 1234
}

    virtual_ipaddress {
        10.243.120.72      #primary IP address
}
    track_script {
        check_rabbitmq     #health check for rabbit
        check_database     #health check for database
}
}

vrrp_script check_rabbitmq {
  script "/etc/keepalived/check_rabbitmq.sh"
  interval 2
  weight -20
}

vrrp_script check_database {
  script "/etc/keepalived/check_database.sh"
  interval 2
  weight -20
}


      
